<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!--<script type="text/javascript" src="http://qzonestyle.gtimg.cn/qzone/openapi/qc_loader.js" data-appid="101541988" data-redirecturi="http://qzonestyle.gtimg.cn/qzone/openapi/redirect-1.0.1.html" charset="utf-8"></script>-->
    <!--<script src="http://qzonestyle.gtimg.cn/qzone/openapi/qc_loader.js" data-appid="101537105"></script>-->
    <!--<script type="text/javascript" src="http://qzonestyle.gtimg.cn/qzone/openapi/qc_loader.js" charset="utf-8" data-appid="100229030" data-redirecturi="http://qzonestyle.gtimg.cn/qzone/openapi/redirect-1.0.1.html" data-xx-oo="xxoo"></script>-->
    <script type="text/javascript"  charset="utf-8"
            src="https://connect.qq.com/qc_jssdk.js"
            data-appid="101537105"
    ></script>
    <!--<script type="text/javascript" src="https://qzonestyle.gtimg.cn/qzone/openapi/qc_loader.js" data-appid="100229030" charset="utf-8"></script>-->
</head>
<body>
<!--<span id="qqLoginBtn"></span>-->
<!--<script type="text/javascript">-->
    <!--QC.Login({-->
        <!--btnId:"qqLoginBtn"	//插入按钮的节点id-->
    <!--});-->
<!--</script>-->
<div>2222222</div>
</body>

<script type="text/javascript">


    let time, count = 0;
    const login = () => {
        if(QC.Login.check()){
            alert("1");
            //已登录，获取用户信息
            QC.api("get_user_info")
                .success(function(s){//成功回调
                    localStorage.setItem('qqUser',JSON.stringify(s.data));
                    clearInterval(time);
                    document.getElementsByTagName("div")[0].innerHTML = s.data.nickname;
                })
                .error(function(f){//失败回调
                    clearInterval(time);
                    alert("获取用户信息失败！");
                });

        }else{
            //未登录，直接打开QQ登录弹窗
            if(!count){
//                alert("2");
//                QC.Login.showPopup({
//                    appId:"100229030",
////                    redirectURI:"http://qzonestyle.gtimg.cn/qzone/openapi/redirect-1.0.1.html"
//                });
//                QC.Login.showPopup();
                window.open('https://graph.qq.com/oauth2.0/authorize?client_id=101537105&response_type=token&scope=all&redirect_uri=http%3A%2F%2Fqzonestyle.gtimg.cn%2Fqzone%2Fopenapi%2Fredirect-1.0.1.html', 'oauth2Login' ,'height=525,width=585, toolbar=no, menubar=no, scrollbars=no, status=no, location=yes, resizable=yes');
                count ++;
            }
        }
    };
    time = setInterval(()=>{
        login();
    }, 1000);
    login();
</script>
</html>